pipeline {
environment { 
imagename = "docker_repo"
}  
  agent any
  
  stages {
    stage ('stage scm'){
      steps {
        git 'https://github.com/dstar55/docker-hello-world-spring-boot.git'
       
      }
    }
      stage ('stage maven'){
        steps {
        sh 'mvn clean install'
      
        
      }  
    }
    stage ('docker build stage')  {
    steps {
    script {
    // This step should not normally be used in your script. Consult the inline help for details.
docker.withRegistry('https://836267957233.dkr.ecr.us-east-2.amazonaws.com/docker_repo','ecr:us-east-2:aws_credentials') {
    // some block
    def myImage = docker.build("${imagename}")
myImage.push("${BUILD_NUMBER}")
}
}
    }
    }
    }
  }
